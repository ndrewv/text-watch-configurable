<!DOCTYPE html>
<html>
	<head>
		<title>TextTime Configuration</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css"/>
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
	</head>
	<body>
		<form name="form" name="form" method="GET">
			<div data-role="page" id="main">
				<div data-role="header" class="jqm-header">
					<h1>TextTime Configuration</h1>
				</div>
				<div id="textDiv">text</div>
				<div data-role="content">
					<div data-role="fieldcontain">
						<label for="background">Background:</label>
						<select name="background" id="background" data-role="slider">
							<option value="0">Black</option>
							<option value="1">White</option>
						</select>
					</div>
					<div data-role="fieldcontain">
						<label for="align">Alignment:</label>
						<select name="align" id="align">
							<option value="0">Left</option>
							<option value="1">Centre</option>
							<option value="2">Right</option>
						</select>
					</div>
					<div data-role="fieldcontain">
						<label for="capital">Capitalise Month:</label>
						<select name="capital" id="capital" data-role="slider">
							<option value="0">Yes</option>
							<option value="1">No</option>
						</select>
					</div>
					<div data-role="fieldcontain">
						<label for="fontupper">Alignment:</label>
						<select name="fontupper" id="fontupper">
							<option value="0">Bitham Bold (Default)</option>
							<option value="1">Bitham</option>
							<option value="2">Effects Eighty</option>
							<option value="3">Effects Eighty Bold</option>
							<option value="4">SFPixelate</option>
							<option value="5">SFPixelate Bold</option>
						</select>
					</div>
					<div data-role="fieldcontain">
						<label for="fontlower">Alignment:</label>
						<select name="fontlower" id="fontlower">
							<option value="1">Bitham (Default)</option>
							<option value="0">Bitham Bold</option>
							<option value="2">Effects Eighty</option>
							<option value="3">Effects Eighty Bold</option>
							<option value="4">SFPixelate</option>
							<option value="5">SFPixelate Bold</option>
						</select>
					</div>
					<div class="ui-body ui-body-b">
						<fieldset class="ui-grid-a">
						<div class="ui-block-a"><button data-theme="d" id="cancel" onclick="return cancelForm();">Cancel</button></div>
						<div class="ui-block-b"><button data-theme="a" id="submit" onclick="return submitForm();">Submit</button></div>
						</fieldset>
					</div>
				</div>
			</div>
		</form>
		<script>
			function submitForm(){
			var variables = {};
			var selects=this.form.getElementsByTagName('select');
			for(var i=0;i<selects.length;i++){
				variables[selects[i].id.toString()]=parseInt(selects[i].value);
			}
			console.log(variables);
			console.log(JSON.stringify(variables));
		            var location = "pebblejs://close#"+encodeURIComponent(JSON.stringify(variables));
		            console.log(location);
	            document.location = location;
			}
			function cancelForm(){
				console.log("Cancel");
          			document.location = "pebblejs://close";
			}
			var config = decodeURIComponent(window.location.search.substr(1));
			document.getElementById("textDiv").innerHTML = "test "+window.location.search.substr(1);
			console.log(config);
			var obj = JSON.parse(config);
			if(obj!==null){
				for (var key in obj){
	  				if(obj.hasOwnProperty(key)){
						var element=document.getElementById(key);
						if (element!==null) {
							element.value=parseInt(obj[key]);
						}
					}
				}
			}
		</script>
	</body>
</html>
